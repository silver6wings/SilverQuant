#!/bin/bash
# å›¢é˜Ÿå…±äº«çš„pre-pushé’©å­ï¼špushå‰è¿è¡Œpytestæµ‹è¯•

echo "ğŸ” è¿è¡Œå•å…ƒæµ‹è¯•ï¼ˆpre-pushé’©å­ï¼‰..."

# å®‰è£…ä¾èµ–ï¼ˆç¡®ä¿æµ‹è¯•ç¯å¢ƒå¯ç”¨ï¼‰
if ! python -m pytest --version >/dev/null 2>&1; then
    echo "âš ï¸ æœªæ£€æµ‹åˆ°pytestï¼Œå°è¯•å®‰è£…ä¾èµ–..."
    pip install -r requirements-dev.txt || {
        echo "âŒ ä¾èµ–å®‰è£…å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å®‰è£…ï¼špip install -r requirements-dev.txt"
        exit 1
    }
fi

# è¿è¡Œpytestæµ‹è¯•
python -m pytest tests/ || {
    echo "âŒ æµ‹è¯•å¤±è´¥ï¼Œç¦æ­¢push"
    exit 1
}

echo "âœ… æµ‹è¯•é€šè¿‡ï¼Œå¯ä»¥push"
exit 0
